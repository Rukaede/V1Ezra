local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "[Beta] Reborn Cultivation by itzRealEzra",
   Icon = 0, 
   LoadingTitle = "Rayfield Interface Suite",
   LoadingSubtitle = "by itzRealEzra",
   ShowText = "Rayfield", 
   Theme = "Default", 
   ToggleUIKeybind = "K", 
   DisableRayfieldPrompts = false,
   DisableBuildWarnings = false, 
   ConfigurationSaving = {
      Enabled = true,
      FolderName = nil,
      FileName = "Kaye Hub"
   },
   Discord = {
      Enabled = false, 
      Invite = "noinvitelink", 
      RememberJoins = true 
   },
   KeySystem = false, 
   KeySettings = {
      Title = "Untitled",
      Subtitle = "Key System",
      Note = "No method of obtaining the key is provided", 
      FileName = "Key",
      SaveKey = true, 
      GrabKeyFromSite = false, 
      Key = {"Hello"} 
   }
})

local MainTab = Window:CreateTab("Farming", nil)
local Tab = Window:CreateTab("Main")

Rayfield:Notify({
   Title = "You executed the script!",
   Content = "Very Good Gui",
   Duration = 5,
   Image = nil,
})

-- âš™ï¸ Services
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local CraftPill = ReplicatedStorage:WaitForChild("Events"):WaitForChild("CraftPill")

-- âš™ï¸ State
local isCrafting = false
local selectedRecipe = "Awaked Qi Pill"
local selectedRarity = "100" -- default rarity
local totalToCraft = 0

-- ðŸ“œ Recipes (no rarity hardcoded)
-- "HerbName" only, rarity will be inserted later
local recipes = {
    ["Awaked Qi Pill"] = {
        "Herb_Blood Flower",
        "Herb_Blood Flower",
        "Herb_Lotus",
        "Herb_Blood Flower",
        1
    },
    -- Example to add more:
    -- ["Lotus Pill"] = {"Herb_Lotus","Herb_Lotus","Herb_Blood Flower","Herb_Blood Flower",1},
}

-- ðŸ“¥ DropDown (choose pill)
local DropDown = Tab:CreateDropdown({
    Name = "Select Pill Recipe",
    Options = {"Awaked Qi Pill"},
    CurrentOption = "Awaked Qi Pill",
    Flag = "DropDown1",
    Callback = function(Option)
        selectedRecipe = Option
    end
})

-- ðŸ“¥ DropDown (choose rarity)
local RarityDrop = Tab:CreateDropdown({
    Name = "Select Rarity",
    Options = {"1","10","100","1000","10000","100000"},
    CurrentOption = "100",
    Flag = "DropDown2",
    Callback = function(Option)
        selectedRarity = Option
    end
})

-- ðŸ“¥ Input box (amount)
local InputBox = Tab:CreateInput({
    Name = "Craft Amount",
    PlaceholderText = "Enter amount (e.g. 1000)",
    RemoveTextAfterFocusLost = false,
    Callback = function(Text)
        local num = tonumber(Text)
        if num and num > 0 then
            totalToCraft = num
        else
            totalToCraft = 0
        end
    end
})

-- ðŸŽ› Toggle (auto craft)
local Toggle = Tab:CreateToggle({
   Name = "Auto Craft",
   CurrentValue = false,
   Flag = "Toggle1",
   Callback = function(Value)
        isCrafting = Value
        if Value and totalToCraft > 0 then
            task.spawn(function()
                for i = 1, totalToCraft do
                    if not isCrafting then break end -- stop if toggle OFF
                    local recipe = recipes[selectedRecipe]
                    if not recipe then break end -- stop if recipe missing

                    -- Build args with selected rarity
                    local args = {
                        recipe[1].."_"..selectedRarity,
                        recipe[2].."_"..selectedRarity,
                        recipe[3].."_"..selectedRarity,
                        recipe[4].."_"..selectedRarity,
                        recipe[5]
                    }

                    CraftPill:FireServer(unpack(args))
                    task.wait(0.05)
                end
                isCrafting = false -- reset after loop finishes
            end)
        end
   end,
})
